# TCP/IP 4계층

TCP/IP 4계층을 기준으로 설명합니다.

## 인터넷 프로토콜 스위트

인터넷 프로토콜 스위트는 인터넷에서 컴퓨터들이 서로 정보를 주고받을 때 쓰이는 프로토콜의 집합입니다.

TCP/IP 4계층 또는 OSI 7계층으로 설명합니다.

[TCP/IP, OSI 구조](<../기초/네트워크 기본규칙.md#osi-모델>)

특정 계층이 변경되었을 때 다른 계층이 영향을 받지 않도록 설계되었습니다.
예를 들어 TCP에서 UDP로 변경되어도 프로그램을 다시 설치할 필요가 없습니다.

## 애플리케이션 계층

애플리케이션 계층에는 FTP, HTTP, SSH, SMTP가 있습니다.

| 프로토콜 | 설명                              |
| :------: | :-------------------------------- |
|   FTP    | 파일 전송 프로토콜                |
|   HTTP   | 웹사이트를 이용하기 위한 프로토콜 |
|   SSH    | 암호화 네트워크 프로토콜          |
|   SMTP   | 전자메일 전송을 위한 프로토콜     |
|   DNS    | [DNS](<../기초/응용 계층.md>)     |

## 전송 계층

전송 계층은 송 수신자를 연결하는 통신 서비스를 제공합니다.

TCP UDP와 프로토콜로는 TCP, UDP가 있습니다.

TCP는 패키지 사이의 순서 보장 연결 지향 프로토콜로 가상 패킷 교환 방식을 사용합니다.
UDP는 순서가 보장되지 않고 수신 여부를 확인하지 않으며 데이터 그램 패킷 교환 방식을 사용합니다.

### 가상 회선 패킷 교환 방식

가장 회선 패킷 교황 반영식은 각 패킷의 가상 회선 식별차가 포함되고 모든 패킷을 전송하면 가상 회선이 해제되고 패킷은 순서대로 도착하게 됩니다.

### 데이터그램 패킷 교환 방식

데이터그램 패킷 교환 방식은 패킷이 독립적으로 이동하며 최적의 경로를 선택하여 갑니다. 각 패킷은 다른 경로로 전송될 수 있고 도착한 순서가 다를 수 있습니다.

### TCP 연결 성립 과정

TCP는 [3way-handshake](<../기초/전송 계층.md#연결-과정-3way-hand-shake>)과정을 통해 신뢰성을 확보합니다.

3way-handshake과정 이후 데이터의 전송을 시작합니다. UDP는 이 과정이 없습니다.

### TCP 연결 해제 과정

TCP가 연결을 해제할 때 [4way-handshake](<../기초/전송 계층.md#종료-과정-4way-hand-shake>) 과정을 수행합니다.

## 인터넷 계층

인터넷 계층은 장치로부터 받은 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위해 사용되는 계층입니다.

IP, ARP, ICMP 프로토콜이 있고 패킷을 수신해야 할 상대의 주소를 지정하여 데이터를 전달합니다.

상대방이 제대로 받았는지에 대해 보장하지 않는 비연결형적인 특징을 가집니다.

## 링크 계층

링크 계층은 전선, 광섬유, 무선 등이 데이터를 전달하여 장치 간의 신호를 주고 받는 규칙을 정하는 계층입니다.

### 유선랜

유선랜은 전 이중화 통신을 씁니다.

#### 전 이중화 통신

[전 이중통신](<../기초/데이터 링크 계층.md#전-이중통신>)은 양쪽 장치가 동시에 송수신될 수 있는 방식입니다. 송신로와 수신로로 나누어 데이터를 주고 받습니다.

#### CSMA/CD

[CSMA/CD](../%EA%B8%B0%EC%B4%88/CACD-CD.md)는 반 이중화 통신으로 데이터를 보낸 후 충돌이 발생하면 일정 시간 이후 재전송합니다.

### 유선 랜의 구성 요소

유선 랜을 이루는 케이블로는 [트위스트 페어 케이블](<../기초/물리 계층.md#트위스트-페어-케이블>), 광섬유 케이블 등이 있습니다.

#### 광섬유 케이블

광섬유 케이블은 레이저를 통하여 통신하고 장거리 고속 통신이 가능합니다.

### 무선 랜

무선 랜은 [반 이중화 통신](<../기초/데이터 링크 계층.md#반-이중통신>)을 사용합니다. 반 이중화 통신은 동시에 통신할 수 없고 한 번에 한 방향으로만 통신할 수 있는 방식입니다.

#### CSMA/CA

CSMA/CA는 반 이중화 통신 중 하나입니다.

장치에서 데이터를 보내기 전에 캐리어 감지 등으로 사전에 가능한 충돌을 방지하는 방식을 사용합니다.

1. 데이터를 송신하기 전에 무선 매체를 살핍니다.
2. 캐리어 감지: 회선이 비어 있는지 판단합니다.
3. IFS (Inner FrameSpace): 랜덤 값을 기반으로 정해진 시간만큼 기다리며 무선 매체가 사용 중이면 그 간격을 늘려가며 기다립니다.
4. 이후에 데이터를 데이터를 송신

#### 무선 랜 구성

무선 랜은 공기를 매체로 주파수를 쏘아 통신망을 구축합니다.

2.4, 5Ghz 대역이 있습니다. 와이파이, AP, 엑세스 포인트 무선 접속 장치로 공유기를 의미합니다.
무선 랜을 이용한 기술로 블루투스, 지그비가 있습니다.

#### BSS

BSS는 기본 서비스의 집합을 의미합니다.

동일 BSS 내 AP와 장치가 서로 통신이 가능한 구조입니다.
다른 사용자가 다른 네트워크에 접속은 불가능합니다.

#### ESS

ESS는 하나 이상의 BSS 그룹입니다. 그룹 내부의 BSS 간위 이동이 가능합니다.

## 이더넷과 프레임

[이더넷](<../기초/데이터 링크 계층.md#이더넷>)은 데이터 링크 계층의 프로토콜이고 [프레임](<../기초/데이터 링크 계층.md#프레임>)은 데이터 링크 계층의 단위입니다.

## 캡슐화, 비캡슐화

- [캡슐화 비캡슐화 과정](<../기초/네트워크 기본규칙.md#흐름>)

캡슐화는 상위 계층에서 하위 계층으로 이동하면서 헤더와 트레일러등이 데이터(페이로드)에 붙으면서 패킷이 점점 커지는 것을 의미하고 비캡슐화는 반대로 하위 계층에서 상위 계층으로 이동할수록 헤더와 트레일러가 제거되고 데이터(페이로드)만 남게되는 것을 말합니다.

## PDU

PDU는 네트워크에 어떤 계층으로 데이터가 전달되는 한 덩어리(단위)입니다.

PDU는 제어 관련 정보들이 포함된 헤더, 데이터를 의미 하는 페이로드로 구성되어있습니다.

PDU는 각 계층마다 부르는 이름이 다릅니다.

|       계층        |                    PDU                    |
| :---------------: | :---------------------------------------: |
| 애플리케이션 계층 |                  메시지                   |
|     전송 계층     |      세그먼트(TCP), 데이터그램(UDP)       |
|    인터넷 계층    |                   패킷                    |
|     링크 계층     | 프레임(데이터 링크 계층), 비트(물리 계층) |
