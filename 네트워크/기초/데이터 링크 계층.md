# 데이터 링크 계층

데이터 링크 계층은 네트워크 장비 간에 신호를 주고받는 규칙을 정하는 계층입니다.

이더넷을 사용합니다. 이더넷은 허브와 같은 장비에 사용합니다.

## 허브에서 생기는 문제점 (이더넷을 사용하는 이유)

허브에 물려있는 여러 대의 컴퓨터가 동시에 데이터를 전송하면 충돌이 발생합니다.

## 이더넷

이더넷은 데이터 링크계층에서 사용하는 프로토콜입니다.

이더넷에는 허브에 연결된 컴퓨터 A가 같은 허브에 연결된 컴퓨터 B에 데이터를 전송하면 컴퓨터 A, B를 제외한 같은 허브에 연결된 컴퓨터들에게 데이터를 전송하는데, 데이터의 내용 중 목적지에 해당하는 부분이 맞지 않다면 무시하는 규칙이 설정되어 있습니다.

이더넷은 [CSMA/CD(Carrier Sence Multiple Access with Collision Detection)](CACD-CD.md)을 사용하는데 이는 여러 컴퓨터가 동시에 데이터를 전송해도 충돌이 발생하지 않는 구조입니다.

## MAC 주소 (물리 주소)

MAC 주소는 전 세계에 유일한 번호로 할당합니다.

총 48 비트, 앞 24비트는 제조사, 뒤 24비트는 랜카드의 일련번호를 의미합니다.

## 이더넷 헤더

이더넷의 헤더는 `목적지 MAC 주소`, `출발지 MAC 주소`, `유형`으로 구성되어 있습니다.

### 유형

유형은 이더넷으로 전송되는 상위 계층 프로토콜의 종류입니다. IPv4, IPv6, ARP, RARP가 있습니다.

### 트레일러

트레일러에서는 데이터에 대한 전송 오류 발생을 확인하는 용도로 FCS라고 부릅니다.

## 프레임

프레임은 위에서 살펴본 이더넷 헤더 + 데이터 + 트레일러로 구성된 데이터 링크 계층에서 사용하는 단위입니다.

이렇게 완성된 프레임은 출발지와 도착지에 대한 MAC 주소를 포함하고 있기 때문에 이더넷 프로토콜의 규칙에 따라 수신 측 컴퓨터에서 도착한 데이터의 도착지 주소가 일치하지 않으면 데이터를 파기합니다.

## 스위치(스위칭 허브)

스위치는 데이터 링크 계층에서 동작하는 기기입니다.

스위치는 MAC 주소 테이블을 가지고 있습니다.

### MAC 주소 테이블

MAC 주소 테이블은 포트 번호와 해당 포트 번호와 연결되어 있는 MAC 주소를 가지고 있는 테이블입니다.

[프레임](#프레임)이 전송되면 MAC 주소 테이블을 확인하고 등록되어 있지 않으면 포트와 함께 등록합니다.

### 플러딩

플러딩은 MAC 주소 테이블에 목적지 MAC 주소에 대한 내용이 없으면 스위치는 스위치에 연결된 모든 컴퓨터에 대해 프레임을 전송하는 현상입니다.

### MAC 주소 필터링

MAC 주소 필터링은 스위치에서 MAC 주소를 기반으로 목적지를 선택하는 것을 의미합니다.

### 전 이중통신

전 이중통신은 데이터의 송수신을 동시에 통신하는 방법입니다.

### 반 이중통신

반 이중통신은 번갈아 가면서 통신하는 방법입니다.

스위치는 충돌이 일어나지 않는 구조로 되어있어 전 이중 통신 방식을 사용합니다.

### 충돌 도메인

충돌 도메인은 허브를 사용할 때 반 이중 방식을 동시에 데이터를 전송 시 발생하는 충돌의 영향의 범위를 의미합니다.
