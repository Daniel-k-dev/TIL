## 트랜젝션

트랜젝션은 데이터베이스에서 하나의 논리적 기능을 수행하기 위한 쿼리 집합입니다.

### 트랜잭션의 특징

트랜잭션의 특징에는 원자성, 일관성, 격리성, 지속성이 있습니다.

이 특성들을 ACID(Atomicity, Consistency, Isolation, Durablity)라고 합니다.

### 원자성(Atomicity)

원자성은 트랜젝션을 구성하는 연산들이 모두 정상적으로 실행되거나 하나로 실행되지 않아야 하는 특성입니다. (all or nothing)

- 커밋: 커밋은 트랜직션이 성공적으로 수행함
- 롤백: 롤백은 트랜직션을 수행하는데 실패함

#### 트랜젝션 전파

트랜젝션 전파는 트랜젝션을 수행할 때 여러 트랜젝션 관련 메소드의 호출을 하나의 트랜젝션으로 묶이도록 하는 것입니다.

### 일관성(Consistency)

일관성은 트랜젝션이 수행된 후에도 데이터 베이스가 일관된 상태를 유지해야 함을 의미한다.

### 격리성(Isolation)

격리성은 현재 실행 중인 트랜잭션이 완료될 때까지 다른 트랜젝션이 접근할 수 없음을 의미합니다.

다른 트랜젝션이 중간 연산 결과에 서로 접근하지 못하도록 합니다.

### 지속성(Durablity)

지속성은 트랜젝션 수행 결과는 영원히 반영돼야 함을 의미합니다.

이런 지속성을 보장하기 위해서는 데이터베이스를 원래대로 회복하는 회복 기능이 필요합니다.

## 격리 수준

격리 수준은 `SERIALIZABLE`, `REPEATABLE_READ`, `READ_COMMITTED`, `READ_UNCOMMITTED`가 있습니다.

`SERIALIZABLE`은 동시성이 낮고 격리성이 높습니다.
`READ_UNCOMMITTED`은 동시성이 높고 격리성이 낮습니다.

### SERIALIZABLE

트랜젝션을 순차적으로 진행합니다. 다른 트랜젝션이 동시에 같은 행의 접근할 수 없다.

### REPEATABLE_READ

하나의 트랜지션이 수행한 행을 다른 트랜지션이 수행할 수 없다. 행 추가는 막지 않는다.

### READ_COMMITTED  

다른 트랜젝션이 커밋하지 않은 정보는 읽을 수 없다. 커밋 완료 데이터에 대해 조회를 허용한다.

### READ_UNCOMMITTED

하나의 트랜잭션이 커밋 되기 이전에 다른 트랜젝션에 노출되는 문제가 있다.

## 격리 수준에 따라 발생하는 현상

|    격리 수준     | 격리 수준에 따라 발생하는 현상              |
| :--------------: | :------------------------------------------ |
| REPEATABLE_READ  | 펜텀 리드                                   |
|  READ_COMMITTED  | 펜텀 리드, 반복 가능하지 않은 조회          |
| READ_UNCOMMITTED | 팬텀리드, 반복 가능하지 않은 조회, 더티리드 |

팬텀리드, 반복 가능하지 않은 조회, 더티리드가 있습니다.

### 펜덤리드

팬텀리드는 한 트랜젝션 내에서 동일한 쿼리를 보냈을 때 해당 조회 결과가 다른 문제입니다.

### 반복 가능하지 않은 조회

한 트랜젝션 내에서 같은 행에 두 번 이상의 조회가 일어났을 때 행 값이 다른 문제입니다.

### 더티리드

한 트랜젝션이 실행 중일 때 다른 트랜젝션에 의해 수정되었지만 커밋이 되어 있지 않아
행의 데이터를 읽을 수 있을 때 발생는 문제입니다.

## 무결성

무결성은 정확성, 일관성, 유효성을 유지하는 것을 의미합니다. 무결성의 종류에는 개체 무결성, 참조 무결성, 고유 무결성이 있습니다.

### 개체 무결성

기본키는 빈 값이 될 수 없다.

### 참조 무결성

서로 참조 관계에 있는 두 테이블의 데이터는 항상 일관되어야 한다.

### 고유 무결성

특정 속성에 대해 고유한 값을 가지도록 조건이 주어지면, 그 속성 값은 모두 고유한 값을 가진다.

### NULL 무결성

특정 속성에 값으로 NULL이 될 수 없다면 그 속성은 NULL이 될 수 없다.
