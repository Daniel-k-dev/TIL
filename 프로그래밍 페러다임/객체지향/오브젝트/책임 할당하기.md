# 책임 할당하기

## 책임 주도 설계를 향해

- 데이터보다 행동을 먼저 결정
- 협력하는 문맥 안에서 책임 결정

## 데이터보다 행동을 먼저 결정

1. 객체가 수행해야 하는 최종 결정
2. 필요한 데이터 결정

## 협력하는 문맥 안에서 책임 결정

책임은 객체의 입장이 아닌 협력 개체 간 협력에 적합해야 한다.

## 책임 주도 설계

- 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임 파악
- 시스템 책임을 더 작은 책임으로 분할
- 분할된 책임을 수행할 수 있는 적절한 객체, 역할을 찾아 할당
- 객체가 책임 수행 중 다른 객체의 도움이 필요하면 이를 책임질 적절한 객체, 역할을 찾는다.
- 해당 객체의 역할, 책임 할당. 두 개체가 협력
 
## 책임 할당을 위한 GRASP 패턴

GRASP (General Responsiblity Assingment Software Pattern)
객체의 책임을 할당할 때 지침으로 삼을 수 있는 원칙들.

### 도메인 개념에서 출발하기

도메인에 대한 개략적인 모습을 그린다.(상세하지 않아도 된다.)

### 정보 전문가에게 책임을 할당한다

1. 메시지를 전송할 객체가 원하는 것.
2. 메시지를 수신하여 적합한 객체 탐색, (Information Expert Pattern)
필요한 정보를 알고 있는 전문가에게 할당

객체가 스스로 처리할 수 있는 작업, 없는 작업을 분리, 없는 작업을 외부의 요청으로 처리

### 높은 응집도, 낮은 결합도

여러 개의 협력 패턴 중에 높은 응집도와 낮은 결합도를 얻을 수 있는 설계가 있다면 그 설계를 선택해야 한다.

## 창조자에게 객체를 생성할 책임을 할당하라

### CREATOR 패턴

- b가 a 객체를 포함하거나 참조한다.
- b가 a 객체를 기록한다.
- b가 a 객체를 긴밀하게 작용한다.
- b가 a 객체를 초기화하는 데 필요한 데이터를 가지고 있다.

조건을 최대한 만족하는 b에게 객체 생성 책임을 할당한다.

### 코드를 통해 변경의 이유 찾기

#### 인스턴스 변수가 초기화되는 시점 확인

응집도가 높은 클래스는 인스턴스 생성 시 모든 속성을 초기화한다. 응집도가 낮으면 일부만 초기화 하고 일부는 초기화하지 않은 상태가 된다. 함께 초기화가 되는 속성을 기준으로 코드를 분리해야 한다.

#### 메서드들이 인스턴스를 사용하는 방식

모든 메서드가 객체의 모든 속성을 사용하면 클래스의 응집도는 높다. 메서드들이 사용하는 속성에 따라 그룹이 나뉜다면 클래스의 응집도는 낮다. 속성 그룹과 해당 그룹에 접근하는 메서드 그룹을 기준으로 코드를 분리해야 한다.

### 변경으로부터 보호하기

변경은 캡슐화하도록 책임을 할당하는 것을 PROTECTED VARIATION 패턴이라 한다.

변화가 예상되는 지점을 식별하고 그 부분에 안정된 인터페이스를 형성하여 책임을 할당한다. 변경된 가능성이 높으면 캡슐화 한다.

## 책임 주도 설계 대안

### 빠르게 목적 기능을 완성하고 리팩터링한다

- 리팩터링 겉으로 보이는 동작을 그대로 유지하고 내부 구조를 변경한다.
- 메소드로 응집도를 높여야 한다. 응집도가 높은 메소드는 변경되는 이유가 단 하나여야 한다.
