## 빈 생명주기 콜백

네트워크와 관련된 객체의 라이프 사이클을 생각해보면 객체 생성후 초기화, 객체 소멸 전 종료을 수행하는 함수가 있다.

**스프링 빈의 이벤트 라이프사이클**

스프링 컨테이너 생성 -> 빈 생성 -> 의존 관계 주입 -> 빈 초기화 콜백 -> 빈 사용 -> 빈 소멸전 콜백

스프링 빈은 빈 객체간 의존관계 주입이 다 끝나고 필요한 데이터에 대해 초기화 한다. 그래서 스프링은 의존관계 주입이 끝난 후의 콜백 메서드, 스프링 컨테이너 종료 전 소멸 콜백을 지원한다.

객체의 생성자 함수에 초기화 함수를 같이 둘 수 있지만 생성자 함수는 객체를 생성하는 것에만 집중하여야 하고 초기화 함수는 객체를 초기화 하는것에만 집중해야 한다. 그래서 별도로 두어야 한다. 그러나 초기화 함수가 무겁지 않다면 생성과 초기화를 동시에 하는 것을 생각해 볼 만하다.

스프링 빈에서 객체 생성 후 초기화, 객체 소멸 전 종료 콜백을 사용하는 방법은 아래와 같다.

### InitializingBean, DisposableBean 인터페이스 상속

초기화와 종료 전 콜백이 필요한 빈 클래스에 `InitializingBean`, `DisposableBean`를 상속 받고 구현한다. `afterPropertiesSet`, `destroy` 메서드 에 각각 초기화와 종료전 실행할 코드를 작성하면 된다.

문제점

- 스프링에 의존적
- 초기화, 소멸 메서드의 이름 변경이 불가
- 외부 라이브러리에 적용 불가

### 스프링 의존 설정 파일에 초기화, 소멸 메서드 지정

스프링 설정 정보에서 초기화, 소멸 메서드를 지정하는 방법이다. `@Bean(initMethod = "초기화 메서드 이름", destroyMethod = "소멸 메서드 이름")`과 같이 사용한다.

`destroyMethod`는 기본적으로 추론하며 만약 `close` , `shutdown`라는 메서드가 있으면 기본값으로 해당 메서드를 실행한다. 해당 기능을 막고 싶으면 `""`으로 처리하면 해결된다.

- 메서드 이름이 자유로움
- 스프링 코드 의존 없음
- 외부 라이브러리도 적용가능

### @PostConstruct, @PreDestroy 어노테이션 사용

초기화 메서드에 `@PostConstruct`를 소멸 메서드에 `@PreDestroy`를 붙여준다.

자바 표준 기술이고 편리하다. 다만 외부 라이브러리에 적용 불가하다. 대신 `@Bean`의 `initMethod`, `destroyMethod`를 이용하면 된다.
