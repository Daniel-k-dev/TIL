# 클래스

자바스크립트의 클래스는 함수입니다. 생성자 함수와 클래스 둘 다 프로토타입 기반 인스턴스를 생성합니다.

클래스의 내부는 strict mode가 지정되어 있습니다. 또한 `super()`, `extends`를 지원합니다.

## 클래스 생성자 함수 비교

생성자 함수 A와 클래스 A는 같은 동작을 수행한다.

```js
function A () {
    // 인스턴스에 b 프로퍼티를 추가
    this.b = 4

    // 프로토타입 객체에 메서드 추가
    Object.prototype.c = () => console.log('c')

    // this 반환
    return this
}

class A {

    constructor() {
        // 인스턴스에 b 프로퍼티를 추가
        this.b = 4
        // 암묵적 this 반환
    }
    
    // 프로토타입 객체에 메서드 추가
    c() {
        console.log('c')
    }    
}
```

클래스와 생성자 함수 비교 이미지 420페이지

## 클래스 호이스팅

클래스는 let, const처럼 [호이스팅](<var, let, const.md#변수-호이스팅>)이 됩니다.

## constructor

클래스의 constructor는 2개 이상이 불가능하고 생략 가능합니다.

constructor 함수 내부는 생성될 인스턴스의 프로퍼티를 추가하며 암묵적으로 this를 반환합니다. 그래서 constructor 함수 내부에 `this.프로퍼티이름` 의 형식으로 값을 할당해야합니다.

## 메서드

클래스에서 선언한 메서드 함수는 프로토타입 객체에 추가됩니다. 생성자 함수 처럼 프로토타입 객체에 직접적으로 프로퍼티를 추가를 안 해도 됩니다.

스테틱 함수는 클래스 함수 객체에 추가되며 인스턴스의 생성 없이 호출이 가능합니다.

메서드 축약 표현이 아닌 클래스의 필드에 함수를 할당하면 인스턴스의 메서드가 됩니다.

## 클래스 인스턴스 생성 과정

클래스 인스턴스 생성 과정은 [생성자 함수 인스턴스 생성 과정](<생성자 함수.md#생성자-함수의-인스턴스-생성-과정>)과 비슷합니다.

1. 인스턴스 생성과 디스 바인딩 암묵적으로 빈 객체를 생성하고 디스 바인딩이 됩니다.
2. 인스턴스 초기화 디스에 바인딩된 인스턴스를 초기화합니다.프로퍼티 추가
3. 인스턴스 반환 디스 바인딩 된 객체를 암묵적으로 반환하게 됩니다.

## 접근자 프로퍼티

프로퍼티 함수에서 사용한 것과 같습니다. [getter setter](<프로퍼티 어트피뷰트.md#접근자-프로퍼티의-프로퍼티-어트리뷰트>)

모든 클래스의 필드는 인스턴스의 프로퍼티가 됩니다.

## 클래스의 상속

기존 클래스를 상속받아 새로운 클래스를 확장합니다.

### 클래스 프로토타입 구조도

![Alt text](images/%ED%81%B4%EB%9E%98%EC%8A%A4/prototype-structure.drawio.svg)

## super()

super()는 함수처럼, 식별자처럼 사용할 수 있습니다.

super()를 호출하면 슈퍼클래스의 constructor를 호출하게 됩니다. -> 슈퍼클래스의 프로퍼티를 가지는 인스턴스 생성
super를 참조하면 슈퍼클래스의 메서드를 호출할 수 있습니다.

super은 상위 프로토타입을 가리킨다. (Object.getPrototypeOf), 정적 함수에서 super 호출은 상위 클래스의 정적 프로퍼티를 가리킨다.

### 슈퍼 호출 시 주의사항

1. sub 클래스에서 constructor를 생략하면 super() 생략이 가능하다. 그러나 sub 클래스에 constructor가 있다면 super()가 있어야 된다.
2. sub 클래스의 constructor에서 super() 호출 이전의 this를 참조할 수 없다.
3. sub 클래스의 constructor에서만 super를 사용한다.

### super 참조

1. super()는 상위 프로토타입을 가리킨다.
2. 정적 메서드의 super()는 상위 클래스를 가리킨다.

### 상속 클래스의 인스턴스 생성 과정

sub 클래스의 super() 호출 자바스크립트 엔진은 클래스 평가 시 super 클래스와 sub 클래스의 구분을 위해 `base`, `derived` 값을 가지는 `[[constructorkind]]` 내부 슬롯을 갖는다.

다른 클래스를 상속받지 않는 클래스는 `base`, 다른 클래스를 상속받는 클래스는 `derived`로 설정된다.

1. sub 클래스는 자신이 직접 인스턴스를 생산하지 않고 super 클래스의 생성을 위임하게 된다.
2. [super 클래스(생성자 함수)의 constructor가 실행되고 과정](<생성자 함수.md#생성자-함수의-인스턴스-생성-과정>) this가 반환된다. 반환된 this 인스턴스는 sub 클래스의 this에 바인딩 된다.
3. this 바인딩 후 초기화 된다. sub 클래스의 constructor의 초기화 과정 진행 후 반환된다.

## 표준 빌트인 함수 확장

extends는 클래스뿐만 아니라 `[[construct]]` 내부 메서드를 가지면 extends가 가능하다.

즉 `Number`, `String`, `Boolean`과 같은 표준 빌트인 함수도 extends가 가능하다.
